<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sprite Diagnostic</title>
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      background: #000; 
      color: #fff; 
      font-family: monospace; 
    }
    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.9);
      padding: 10px;
      border-radius: 5px;
      font-size: 12px;
      z-index: 1000;
      max-width: 400px;
    }
  </style>
</head>
<body>
  <div id="info">Loading diagnostic...</div>
  
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
  
  <script>
    class DiagnosticScene extends Phaser.Scene {
      constructor() {
        super({ key: 'DiagnosticScene' });
        this.loadResults = [];
      }
      
      preload() {
        console.log('Starting sprite diagnostic...');
        const info = document.getElementById('info');
        info.innerHTML = 'Loading sprites...<br>';
        
        // Test loading each sprite with error handling
        const testSprites = [
          { key: 'alex', file: 'NES - River City Ransom _ Street Gangs - Playable Characters - Alex.png', width: 16, height: 24 },
          { key: 'ryan', file: 'NES - River City Ransom _ Street Gangs - Playable Characters - Ryan.png', width: 16, height: 24 },
          { key: 'enemy1', file: 'NES - River City Ransom _ Street Gangs - Enemies & Bosses - Gang Member - Type 1.png', width: 32, height: 32 },
          { key: 'enemy2', file: 'NES - River City Ransom _ Street Gangs - Enemies & Bosses - Gang Member - Type 2.png', width: 32, height: 32 },
          { key: 'downtown', file: 'NES - River City Ransom _ Street Gangs - Backgrounds - Downtown.png', width: null, height: null }
        ];
        
        testSprites.forEach(sprite => {
          console.log(`Loading ${sprite.key} from ${sprite.file}`);
          
          if (sprite.width && sprite.height) {
            // Load as spritesheet
            this.load.spritesheet(sprite.key, sprite.file, {
              frameWidth: sprite.width,
              frameHeight: sprite.height
            });
          } else {
            // Load as single image
            this.load.image(sprite.key, sprite.file);
          }
          
          // Also load as image to test basic loading
          this.load.image(sprite.key + '_img', sprite.file);
        });
        
        // Set up load event handlers
        this.load.on('filecomplete', (key, type, data) => {
          console.log(`✓ Loaded: ${key} (${type})`);
          this.loadResults.push(`✓ ${key} (${type})`);
        });
        
        this.load.on('loaderror', (file) => {
          console.error(`✗ Failed to load: ${file.key} from ${file.url}`);
          this.loadResults.push(`✗ ${file.key} - ${file.url}`);
        });
        
        this.load.on('complete', () => {
          console.log('Load complete!');
          this.updateInfo();
        });
      }
      
      create() {
        console.log('Creating diagnostic scene...');
        this.updateInfo();
        
        let y = 50;
        const scale = 3;
        
        // Test displaying loaded sprites
        if (this.textures.exists('alex')) {
          console.log('Alex texture exists');
          const alex = this.add.sprite(100, y, 'alex', 0);
          alex.setScale(scale);
          this.add.text(150, y - 10, 'Alex (16x24)', { fill: '#fff', fontSize: '12px' });
          y += 60;
        }
        
        if (this.textures.exists('enemy1')) {
          console.log('Enemy1 texture exists');
          const enemy1 = this.add.sprite(100, y, 'enemy1', 0);
          enemy1.setScale(scale);
          this.add.text(150, y - 10, 'Enemy1 (32x32)', { fill: '#fff', fontSize: '12px' });
          y += 60;
        }
        
        if (this.textures.exists('enemy1_img')) {
          console.log('Enemy1_img texture exists');
          const enemy1_img = this.add.image(100, y, 'enemy1_img');
          enemy1_img.setScale(1);
          this.add.text(150, y - 10, 'Enemy1 (full image)', { fill: '#fff', fontSize: '12px' });
          y += 100;
        }
        
        if (this.textures.exists('downtown')) {
          console.log('Downtown texture exists');
          const bg = this.add.image(400, 300, 'downtown');
          bg.setAlpha(0.3);
          bg.setDisplaySize(800, 600);
        }
        
        // List all available textures
        console.log('Available textures:', this.textures.list);
      }
      
      updateInfo() {
        const info = document.getElementById('info');
        const textureCount = Object.keys(this.textures.list).length - 1; // -1 for __DEFAULT
        
        let html = `<strong>SPRITE DIAGNOSTIC RESULTS</strong><br>`;
        html += `Textures loaded: ${textureCount}<br><br>`;
        
        if (this.loadResults.length > 0) {
          html += '<strong>Load Results:</strong><br>';
          this.loadResults.forEach(result => {
            html += result + '<br>';
          });
        }
        
        html += '<br><strong>Available Textures:</strong><br>';
        Object.keys(this.textures.list).forEach(key => {
          if (key !== '__DEFAULT') {
            const texture = this.textures.get(key);
            html += `${key} (${texture.source[0].width}x${texture.source[0].height})<br>`;
          }
        });
        
        info.innerHTML = html;
      }
    }
    
    const config = {
      type: Phaser.CANVAS,
      width: 800,
      height: 600,
      backgroundColor: '#2c3e50',
      scene: DiagnosticScene,
      render: {
        pixelArt: true,
        antialias: false
      }
    };
    
    const game = new Phaser.Game(config);
  </script>
</body>
</html>
